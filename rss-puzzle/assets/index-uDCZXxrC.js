(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function c(e){const t=document.createElement(e.tag);return e.className&&(t.className=e.className),e.textContent&&(t.textContent=e.textContent),e.id&&(t.id=e.id),e.dataset&&Object.entries(e.dataset).forEach(([n,a])=>{t.dataset[n]=a}),e.src!==void 0&&t.setAttribute("src",e.src),e.href!==void 0&&t.setAttribute("href",e.href),e.type!==void 0&&t.setAttribute("type",e.type),e.value!==void 0&&t.setAttribute("value",e.value),e.placeholder!==void 0&&t.setAttribute("placeholder",e.placeholder),e.checked!==void 0&&(e.checked?t.setAttribute("checked",""):t.removeAttribute("checked")),e.style&&(typeof e.style=="string"?t.style.cssText=e.style:Object.assign(t.style,e.style)),t}function re(e,t,n,a){const o=n,l=a;let i=!0;return e.value===""&&(o.textContent="Fill in the required fields",e.classList.add("authorization__first-name--invalid"),i=!1),t.value===""&&(l.textContent="Fill in the required fields",t.classList.add("authorization__last-name--invalid"),i=!1),e.value.length<3&&e.value!==""&&(o.textContent="Minimum 3 letters",i=!1),t.value.length<4&&t.value!==""&&(l.textContent="Minimum 4 letters",i=!1),i}function O(e,t){let n=!0;const a=t,o=/^[a-zA-Z-]*$/,l=/^[A-Z][a-zA-Z-]*$/,i=e.value.trim();return o.test(i)?l.test(i)?i.endsWith("-")?(a.textContent='Cannot end with "-"',n=!1):a.textContent="":(a.textContent="Start with a capital letter",n=!1):(a.textContent='Only English letters and "-""',n=!1),n}function ce(e,t){const n={firstName:e,lastName:t};localStorage.setItem("userData",JSON.stringify(n))}function ue(){localStorage.removeItem("userData")}function de(){ue()}function ge(){const e=localStorage.getItem("userData");if(e){const{firstName:t}=JSON.parse(e),{lastName:n}=JSON.parse(e);return`${t} ${n}`}return""}function pe(e,t){const n="completedRounds",a=localStorage.getItem(n),o=a?JSON.parse(a):{},l=`level${e}`,i=o[l]||[];i.includes(t)||(i.push(t),i.sort((d,u)=>d-u),o[l]=i,localStorage.setItem(n,JSON.stringify(o)))}function D(){const e=localStorage.getItem("completedRounds");return e?JSON.parse(e):null}const G=new Map;function R(e,t){G.set(e,t)}async function w(e){const t=document.getElementById("app");if(!t)return;const n=G.get(e);n&&t.replaceChildren(n())}function me(){const e=c({tag:"div",className:"authorization__container"}),t=c({tag:"h2",className:"authorization__title",textContent:"Authorization"}),n=c({tag:"input",className:"authorization__first-name",type:"text",placeholder:"First name",id:"first"});n.required=!0;const a=c({tag:"input",className:"authorization__last-name",type:"text",placeholder:"Last name",id:"Last"});a.required=!0;const o=c({tag:"button",className:"authorization__login-btn",type:"submit",textContent:"Login"}),l=c({tag:"div",className:"authorization__hint-first",textContent:""}),i=c({tag:"div",className:"authorization__hint-last",textContent:""});return n.addEventListener("input",()=>{n.classList.remove("authorization__first-name--invalid"),O(n,l)}),a.addEventListener("input",()=>{a.classList.remove("authorization__last-name--invalid"),O(a,i)}),o.addEventListener("click",()=>{const d=re(n,a,l,i),u=O(n,l);d&&u&&(ce(n.value,a.value),w("start"))}),e.append(t,n,l,a,i,o),e}const fe={text:"RSS Puzzle is an interactive mini-game aimed at enhancing English language skills. Players assemble sentences from jumbled words, inspired by Lingualeo's Phrase Constructor training. The game integrates various levels of difficulty, hint options, and a unique puzzle-like experience with artwork."};function he(){const e=c({tag:"div",className:"start-page"}),t=c({tag:"button",className:"start-page__logout-btn",textContent:"logout"}),n=c({tag:"div",className:"start-page__header"}),a=c({tag:"div",className:"start-page__logo"}),o=c({tag:"h1",textContent:"RSS Puzzle",className:"start-page__title"}),l=c({tag:"div",className:"start-page__content"}),i=c({tag:"p",className:"start-page__description",textContent:fe.text});t.addEventListener("click",()=>{de(),w("login")});const d=c({tag:"p",className:"start-page__reetings",textContent:`Hello, ${ge()??""}! Let's solve some puzzles!`}),u=c({tag:"button",className:"start-page__start-button",textContent:"Start"});return u.addEventListener("click",()=>{w("game")}),n.append(a,o,t),l.append(i,d,u),e.append(n,l),e}const s={allWords:[],sourceWords:[],resultWords:[],translation:[],currentTranslation:"",pages:0,level:1,round:0,isRoundOver:!1,hint:!1,audioPaths:[],currentAudioPath:""};function ve(){s.allWords=[],s.sourceWords=[],s.resultWords=[],s.translation=[],s.currentTranslation="",s.audioPaths=[],s.currentAudioPath=""}async function U(e){try{const t=await fetch(`/rss-puzzle/rss-puzzle-data/data/wordCollectionLevel${e}.json`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);ve();const n=await t.json();return n.rounds[s.round].words.forEach(a=>{s.allWords.push(a.textExample),s.translation.push(a.textExampleTranslate),s.audioPaths.push(a.audioExample)}),s.sourceWords=s.allWords.shift()?.split(" ")??[],s.currentTranslation=s.translation.shift()??"",s.currentAudioPath=s.audioPaths.shift()??"",s.pages=n.rounds.length,s.resultWords.length=0,s}catch(t){console.error("Error loading JSON:",t);return}}function _e(){s.isRoundOver=!0}function be(){if(s.allWords.length===0){_e(),s.sourceWords=[],s.resultWords=[],s.currentTranslation="";return}s.sourceWords=s.allWords.shift()?.split(" ")??[],s.currentTranslation=s.translation.shift()??"",s.currentAudioPath=s.audioPaths.shift()??"",s.resultWords.length=0}function ye(){return structuredClone(s)}function Ce(e){s.resultWords.push(e)}function ze(e){s.resultWords=s.resultWords.filter(t=>t!==e)}function ke(){return s.sourceWords.join(" ")===s.resultWords.join(" ")}async function xe(){s.round+=1,await U(s.level)}function K(e){s.round=e-1}async function Le(){s.isRoundOver=!1,await xe()}function Z(){return s.sourceWords.length===s.resultWords.length}function Se(){const e=[];return s.resultWords.forEach((t,n)=>{t!==s.sourceWords[n]&&e.push(t)}),e}function Ne(e){s.hint=e}function Ee(){return structuredClone(s.hint)}function Pe(e){const t=[...e];for(let n=t.length-1;n>0;n-=1){const a=Math.floor(Math.random()*(n+1));[t[n],t[a]]=[t[a],t[n]]}return t}let r=null,$=null,V=0,Q=0,N=!1,b,ee=0,te=0;const H=5;let x=null,L=null,S=null;function We(){return N}function we(e,t){if(e.preventDefault(),e.stopPropagation(),!r)return;const n=Math.abs(e.clientX-ee),a=Math.abs(e.clientY-te);if(!N){if(n<H&&a<H)return;N=!0}r.style.width=`${b.width}px`,r.style.height=`${b.height}px`,r.style.flex="0 0 auto",r.style.maxWidth="none",r.style.minWidth="unset",r.style.position="fixed",r.style.left=`${b.left}px`,r.style.top=`${b.top}px`,r.style.zIndex="1000",r.style.pointerEvents="none",r.classList.add("dragging"),r.style.left=`${e.clientX-V}px`,r.style.top=`${e.clientY-Q}px`;const o=r.dataset.position==="puzzle-block"?document.querySelector(".game-page__touch-block"):t.lastChild;o instanceof HTMLElement&&o.classList.add("hover")}function Te(){if(r&&x!==null)try{r.releasePointerCapture(x)}catch{throw new Error("activePointerId error")}r&&(r.classList.remove("dragging"),r.style.position="",r.style.left="",r.style.top="",r.style.width="",r.style.height="",r.style.zIndex="",r.style.pointerEvents="",r.style.flex="",r.style.maxWidth="",r.style.minWidth=""),document.querySelectorAll(".game-page__puzzle-string").forEach(e=>e.classList.remove("hover")),document.querySelector(".game-page__touch-block")?.classList.remove("hover"),N=!1,r=null,$=null,x=null,L&&(document.removeEventListener("pointermove",L),L=null),S&&(document.removeEventListener("pointerup",S),S=null)}function Ae(e,t,n){const a=document.elementFromPoint(e,t),o=a?.closest(".game-page__puzzle-string"),l=a?.closest(".game-page__touch-block");return r&&r.dataset.position==="touch-block"&&o?n.lastElementChild:r&&r.dataset.position==="puzzle-block"&&l?document.querySelector(".game-page__touch-block"):null}function Be(e,t,n){if(r){if(N){const a=Ae(e.clientX,e.clientY,n);a&&(a.appendChild(r),t())}Te()}}function Oe(e,t,n){e.preventDefault(),e.stopPropagation(),r=e.target,r&&($=r.closest(".game-page__touch-block")||r.closest(".game-page__puzzle-string"),$&&(b=r.getBoundingClientRect(),V=e.clientX-b.left,Q=e.clientY-b.top,ee=e.clientX,te=e.clientY,x=e.pointerId,r.setPointerCapture(x),L=a=>we(a,t),S=a=>Be(a,n,t),document.addEventListener("pointermove",L),document.addEventListener("pointerup",S)))}async function q(e){return U(e)}function f(){return ye()}function Re(e){Ce(e)}function Ie(e){ze(e)}function $e(){return ke()}function De(e){const t=e;t.disabled=!0}function ne(e){e.classList.add("game-page__check-btn--inactive")}function ae(e){const t=e;t.disabled=!0,t.classList.remove("game-page__continue-btn--active")}function oe(e){const t=e;t.disabled=!1,t.classList.add("game-page__continue-btn--active")}function qe(e){const t=e;Z()&&(t.disabled=!1)}function se(e){e.classList.remove("game-page__check-btn--inactive")}function Me(e,t){const n=t;e.classList.remove("game-page__touch-element--invalid"),n.disabled=!0}function ie(e){const n=e.lastElementChild?.children;n&&Array.from(n).forEach(a=>{a instanceof HTMLElement&&a.classList.remove("game-page__touch-element--invalid")})}function je(e,t,n,a){const o=e.lastElementChild;if(!o)return;const l=f(),{sourceWords:i}=l;o.replaceChildren(),a.replaceChildren(),i.forEach(d=>{const u=c({tag:"div",className:"game-page__touch-element",textContent:d,dataset:{position:"puzzle-block"}});i.indexOf(d)===0&&u.classList.add("first"),i.indexOf(d)===i.length-1&&u.classList.add("last"),o?.append(u)}),oe(t),ne(n),ie(e),o.dataset.finish="finish"}function J(e,t,n,a,o,l){const i=t,d=e;e.dataset.finish||(i.dataset.position==="touch-block"?(d.append(t),i.dataset.position="puzzle-block",Re(t.textContent??""),$e()&&(oe(n),De(a),ne(a),ie(o),d.dataset.finish="finish"),qe(a)):t.dataset.position==="puzzle-block"&&(Me(t,a),ae(n),l.append(t),i.dataset.position="touch-block",Ie(t.textContent??""),se(a)))}function I(e){const t=e,n=f().currentTranslation;return t.textContent=n,n}function W(e,t,n,a){const o=f(),{sourceWords:l}=o,i=c({tag:"div",className:"game-page__puzzle-string"});t.append(i),Pe(l).forEach(d=>{const u=c({tag:"div",className:"game-page__touch-element",textContent:d,dataset:{position:"touch-block"}});l.indexOf(d)===0&&u.classList.add("first"),l.indexOf(d)===l.length-1&&u.classList.add("last"),e.append(u),u.addEventListener("pointerdown",h=>{h.target.closest(".game-page__puzzle-string")?.dataset.finish!=="finish"&&Oe(h,t,()=>{J(i,u,n,a,t,e)})}),u.addEventListener("pointerup",()=>{We()||J(i,u,n,a,t,e)})})}function Fe(e,t){const n=e;n.options[n.selectedIndex].classList.add("completed"),pe(Number(t.value),Number(e.value));const a=f().round+1;n.value=String(a)}async function He(e,t,n,a,o,l){be(),D(),f().isRoundOver&&(t.replaceChildren(),await Le(),Fe(o,l)),W(e,t,n,a)}function Je(e){const t=e;Se().includes(t.textContent??"")&&Z()?t.classList.add("game-page__touch-element--invalid"):t.classList.remove("game-page__touch-element--invalid")}function X(e){Ne(e)}function Y(){return Ee()}let z=null,P=!1;function Xe(e,t){if(P)return;const n=f().currentAudioPath;z?z.src=n:z=new Audio(n),P=!0;const a=e,o=t;a.classList.remove("game-page__speaker-btn--inactive"),o.src="/rss-puzzle/icons/speaker_162093.png",z.onended=()=>{P=!1,e.classList.add("game-page__speaker-btn--inactive"),o.src="/rss-puzzle/icons/silent_2757171.png"},z.onerror=()=>{P=!1,e.classList.add("game-page__speaker-btn--inactive"),o.src="/rss-puzzle/icons/silent_2757171.png"},z.play()}function Ye(){return D()}async function Ge(e){await q(e);const t=f(),n=document.querySelector(".page");n.replaceChildren(),document.querySelector(".game-page__touch-block")?.replaceChildren(),document.querySelector(".game-page__audio-block")?.replaceChildren(),document.querySelector(".game-page__puzzle-block")?.replaceChildren();const d=D()[`level${e}`];for(let u=1;u<=t.pages;u+=1){const h=c({tag:"option",className:"game-page__option-level",textContent:String(u),value:String(u)});d.includes(u)&&h.classList.add("completed"),n.append(h)}}function Ue(e){K(e)}async function Ke(e,t){K(e),await q(t),document.querySelector(".game-page__touch-block")?.replaceChildren(),document.querySelector(".game-page__audio-block")?.replaceChildren(),document.querySelector(".game-page__puzzle-block")?.replaceChildren()}function Ze(){const e=f().pages,t=c({tag:"div",className:"game-page__container"}),n=c({tag:"div",className:"game-page__control-panel"}),a=c({tag:"div",className:"game-page__lable-level",textContent:"Level"}),o=c({tag:"select",className:"game-page__select-level"});for(let g=1;g<=6;g+=1){const _=c({tag:"option",className:"game-page__option-level",textContent:String(g),value:String(g)});o.append(_)}const l=c({tag:"div",className:"game-page__lable-level",textContent:"Page"}),i=c({tag:"select",className:"game-page__select-level page"}),u=Ye()?.level1??[];for(let g=1;g<=e;g+=1){const _=c({tag:"option",className:"game-page__option-level",textContent:String(g),value:String(g)});u.length>0&&u.includes(g)&&_.classList.add("completed"),i.append(_)}const h=c({tag:"div",className:"game-page__drop-block"});h.append(a,o,l,i);const T=c({tag:"div",className:"game-page__btn-block"}),y=c({tag:"button",className:"game-page__hint-btn game-page__hint-btn--inactive"}),A=c({tag:"img",className:"game-page__hint-img"});y.append(A),A.src="/rss-puzzle/icons/hint.png";const E=c({tag:"button",className:"game-page__speaker-btn game-page__speaker-btn--inactive"}),B=c({tag:"img",className:"game-page__speaker-img"});E.append(B),B.src="/rss-puzzle/icons/silent_2757171.png",E.addEventListener("click",()=>{Xe(E,B)});const k=c({tag:"div",className:"game-page__audio-block"});f().hint&&I(k),y.addEventListener("click",()=>{Y()?(X(!1),y.classList.add("game-page__hint-btn--inactive")):(X(!0),I(k),y.classList.remove("game-page__hint-btn--inactive"))});const v=c({tag:"div",className:"game-page__puzzle-block"}),C=c({tag:"div",className:"game-page__touch-block"}),m=c({tag:"button",className:"game-page__continue-btn",textContent:"Continue"}),p=c({tag:"button",className:"game-page__check-btn",textContent:"Check"});p.disabled=!0,p.addEventListener("click",()=>{const _=v.lastElementChild?.children;_&&Array.from(_).forEach(F=>{F instanceof HTMLElement&&Je(F)})}),o.addEventListener("change",async()=>{Ue(1),await Ge(Number(o.value)),W(C,v,m,p)}),i.addEventListener("change",async()=>{await Ke(Number(i.value),Number(o.value)),W(C,v,m,p)}),W(C,v,m,p);const M=c({tag:"div",className:"game-page__confirmation-block"});m.disabled=!0,m.addEventListener("click",()=>{He(C,v,m,p,i,o),ae(m),p.disabled=!0,se(p),k.textContent="",Y()&&I(k)});const j=c({tag:"button",className:"game-page__auto-complete-btn",textContent:"Autocomplete"});return j.addEventListener("click",()=>{je(v,m,p,C)}),M.append(p,m,j),T.append(y,E),n.append(h,T),t.append(n,k,v,C,M),t}function Ve(){const e=localStorage.getItem("userData");R("login",me),R("start",he),R("game",Ze),w(e?"start":"login"),q(1)}const{body:Qe}=document,le=document.createElement("div");le.id="app";Qe.prepend(le);Ve();
