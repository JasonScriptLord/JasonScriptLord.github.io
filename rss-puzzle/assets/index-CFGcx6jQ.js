(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(s){if(s.ep)return;s.ep=!0;const c=n(s);fetch(s.href,c)}})();function r(e){const t=document.createElement(e.tag);return e.className&&(t.className=e.className),e.textContent&&(t.textContent=e.textContent),e.id&&(t.id=e.id),e.dataset&&Object.entries(e.dataset).forEach(([n,a])=>{t.dataset[n]=a}),e.src!==void 0&&t.setAttribute("src",e.src),e.href!==void 0&&t.setAttribute("href",e.href),e.type!==void 0&&t.setAttribute("type",e.type),e.value!==void 0&&t.setAttribute("value",e.value),e.placeholder!==void 0&&t.setAttribute("placeholder",e.placeholder),e.checked!==void 0&&(e.checked?t.setAttribute("checked",""):t.removeAttribute("checked")),e.style&&(typeof e.style=="string"?t.style.cssText=e.style:Object.assign(t.style,e.style)),t}function oe(e,t,n,a){const s=n,c=a;let i=!0;return e.value===""&&(s.textContent="Fill in the required fields",e.classList.add("authorization__first-name--invalid"),i=!1),t.value===""&&(c.textContent="Fill in the required fields",t.classList.add("authorization__last-name--invalid"),i=!1),e.value.length<3&&e.value!==""&&(s.textContent="Minimum 3 letters",i=!1),t.value.length<4&&t.value!==""&&(c.textContent="Minimum 4 letters",i=!1),i}function A(e,t){let n=!0;const a=t,s=/^[a-zA-Z-]*$/,c=/^[A-Z][a-zA-Z-]*$/,i=e.value.trim();return s.test(i)?c.test(i)?i.endsWith("-")?(a.textContent='Cannot end with "-"',n=!1):a.textContent="":(a.textContent="Start with a capital letter",n=!1):(a.textContent='Only English letters and "-""',n=!1),n}function ie(e,t){const n={firstName:e,lastName:t};localStorage.setItem("userData",JSON.stringify(n))}function le(){localStorage.removeItem("userData")}function re(){le()}function ce(){const e=localStorage.getItem("userData");if(e){const{firstName:t}=JSON.parse(e),{lastName:n}=JSON.parse(e);return`${t} ${n}`}return""}const H=new Map;function B(e,t){H.set(e,t)}async function w(e){const t=document.getElementById("app");if(!t)return;const n=H.get(e);n&&t.replaceChildren(n())}function ue(){const e=r({tag:"div",className:"authorization__container"}),t=r({tag:"h2",className:"authorization__title",textContent:"Authorization"}),n=r({tag:"input",className:"authorization__first-name",type:"text",placeholder:"First name",id:"first"});n.required=!0;const a=r({tag:"input",className:"authorization__last-name",type:"text",placeholder:"Last name",id:"Last"});a.required=!0;const s=r({tag:"button",className:"authorization__login-btn",type:"submit",textContent:"Login"}),c=r({tag:"div",className:"authorization__hint-first",textContent:""}),i=r({tag:"div",className:"authorization__hint-last",textContent:""});return n.addEventListener("input",()=>{n.classList.remove("authorization__first-name--invalid"),A(n,c)}),a.addEventListener("input",()=>{a.classList.remove("authorization__last-name--invalid"),A(a,i)}),s.addEventListener("click",()=>{const u=oe(n,a,c,i),d=A(n,c);u&&d&&(ie(n.value,a.value),w("start"))}),e.append(t,n,c,a,i,s),e}const de={text:"RSS Puzzle is an interactive mini-game aimed at enhancing English language skills. Players assemble sentences from jumbled words, inspired by Lingualeo's Phrase Constructor training. The game integrates various levels of difficulty, hint options, and a unique puzzle-like experience with artwork."};function ge(){const e=r({tag:"div",className:"start-page"}),t=r({tag:"button",className:"start-page__logout-btn",textContent:"logout"}),n=r({tag:"div",className:"start-page__header"}),a=r({tag:"div",className:"start-page__logo"}),s=r({tag:"h1",textContent:"RSS Puzzle",className:"start-page__title"}),c=r({tag:"div",className:"start-page__content"}),i=r({tag:"p",className:"start-page__description",textContent:de.text});t.addEventListener("click",()=>{re(),w("login")});const u=r({tag:"p",className:"start-page__reetings",textContent:`Hello, ${ce()??""}! Let's solve some puzzles!`}),d=r({tag:"button",className:"start-page__start-button",textContent:"Start"});return d.addEventListener("click",()=>{w("game")}),n.append(a,s,t),c.append(i,u,d),e.append(n,c),e}const o={allWords:[],sourceWords:[],resultWords:[],translation:[],currentTranslation:"",pages:0,level:1,round:0,isRoundOver:!1,hint:!1,audioPaths:[],currentAudioPath:""};function pe(){o.allWords=[],o.sourceWords=[],o.resultWords=[],o.translation=[],o.currentTranslation="",o.audioPaths=[],o.currentAudioPath=""}async function X(e){try{const t=await fetch(`/jasonscriptlord-JSFE2025Q3/rss-puzzle/rss-puzzle-data/data/wordCollectionLevel${e}.json`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);pe();const n=await t.json();return n.rounds[o.round].words.forEach(a=>{o.allWords.push(a.textExample),o.translation.push(a.textExampleTranslate),o.audioPaths.push(a.audioExample)}),o.sourceWords=o.allWords.shift()?.split(" ")??[],o.currentTranslation=o.translation.shift()??"",o.currentAudioPath=o.audioPaths.shift()??"",o.pages=n.rounds.length,o.resultWords.length=0,o}catch(t){console.error("Error loading JSON:",t);return}}function fe(){o.isRoundOver=!0}function me(){if(o.allWords.length===0){fe(),o.sourceWords=[],o.resultWords=[],o.currentTranslation="";return}o.sourceWords=o.allWords.shift()?.split(" ")??[],o.currentTranslation=o.translation.shift()??"",o.currentAudioPath=o.audioPaths.shift()??"",o.resultWords.length=0}function he(){return structuredClone(o)}function _e(e){o.resultWords.push(e)}function ve(e){o.resultWords=o.resultWords.filter(t=>t!==e)}function be(){return o.sourceWords.join(" ")===o.resultWords.join(" ")}async function ye(){o.round+=1,await X(o.level)}function Y(e){o.round=e-1}async function ze(){o.isRoundOver=!1,await ye()}function G(){return o.sourceWords.length===o.resultWords.length}function ke(){const e=[];return o.resultWords.forEach((t,n)=>{t!==o.sourceWords[n]&&e.push(t)}),e}function Ce(e){o.hint=e}function xe(){return structuredClone(o.hint)}function Le(e){const t=[...e];for(let n=t.length-1;n>0;n-=1){const a=Math.floor(Math.random()*(n+1));[t[n],t[a]]=[t[a],t[n]]}return t}let l=null,R=null,Q=0,U=0,S=!1,v,Z=0,K=0;const D=5;let x=null,L=null,E=null;function Ee(){return S}function Se(e,t){if(e.preventDefault(),e.stopPropagation(),!l)return;const n=Math.abs(e.clientX-Z),a=Math.abs(e.clientY-K);if(!S){if(n<D&&a<D)return;S=!0}l.style.width=`${v.width}px`,l.style.height=`${v.height}px`,l.style.flex="0 0 auto",l.style.maxWidth="none",l.style.minWidth="unset",l.style.position="fixed",l.style.left=`${v.left}px`,l.style.top=`${v.top}px`,l.style.zIndex="1000",l.style.pointerEvents="none",l.classList.add("dragging"),l.style.left=`${e.clientX-Q}px`,l.style.top=`${e.clientY-U}px`;const s=l.dataset.position==="puzzle-block"?document.querySelector(".game-page__touch-block"):t.lastChild;s instanceof HTMLElement&&s.classList.add("hover")}function Ne(){if(l&&x!==null)try{l.releasePointerCapture(x)}catch{throw new Error("activePointerId error")}l&&(l.classList.remove("dragging"),l.style.position="",l.style.left="",l.style.top="",l.style.width="",l.style.height="",l.style.zIndex="",l.style.pointerEvents="",l.style.flex="",l.style.maxWidth="",l.style.minWidth=""),document.querySelectorAll(".game-page__puzzle-string").forEach(e=>e.classList.remove("hover")),document.querySelector(".game-page__touch-block")?.classList.remove("hover"),S=!1,l=null,R=null,x=null,L&&(document.removeEventListener("pointermove",L),L=null),E&&(document.removeEventListener("pointerup",E),E=null)}function Pe(e,t,n){const a=document.elementFromPoint(e,t),s=a?.closest(".game-page__puzzle-string"),c=a?.closest(".game-page__touch-block");return l&&l.dataset.position==="touch-block"&&s?n.lastElementChild:l&&l.dataset.position==="puzzle-block"&&c?document.querySelector(".game-page__touch-block"):null}function We(e,t,n){if(l){if(S){const a=Pe(e.clientX,e.clientY,n);a&&(a.appendChild(l),t())}Ne()}}function we(e,t,n){e.preventDefault(),e.stopPropagation(),l=e.target,l&&(R=l.closest(".game-page__touch-block")||l.closest(".game-page__puzzle-string"),R&&(v=l.getBoundingClientRect(),Q=e.clientX-v.left,U=e.clientY-v.top,Z=e.clientX,K=e.clientY,x=e.pointerId,l.setPointerCapture(x),L=a=>Se(a,t),E=a=>We(a,n,t),document.addEventListener("pointermove",L),document.addEventListener("pointerup",E)))}async function I(e){return X(e)}function h(){return he()}function Te(e){_e(e)}function Ae(e){ve(e)}function Be(){return be()}function Oe(e){const t=e;t.disabled=!0}function V(e){e.classList.add("game-page__check-btn--inactive")}function ee(e){const t=e;t.disabled=!0,t.classList.remove("game-page__continue-btn--active")}function te(e){const t=e;t.disabled=!1,t.classList.add("game-page__continue-btn--active")}function Re(e){const t=e;G()&&(t.disabled=!1)}function ne(e){e.classList.remove("game-page__check-btn--inactive")}function Ie(e,t){const n=t;e.classList.remove("game-page__touch-element--invalid"),n.disabled=!0}function ae(e){const n=e.lastElementChild?.children;n&&Array.from(n).forEach(a=>{a instanceof HTMLElement&&a.classList.remove("game-page__touch-element--invalid")})}function $e(e,t,n,a){const s=e.lastElementChild;if(!s)return;const c=h(),{sourceWords:i}=c;s.replaceChildren(),a.replaceChildren(),i.forEach(u=>{const d=r({tag:"div",className:"game-page__touch-element",textContent:u,dataset:{position:"puzzle-block"}});i.indexOf(u)===0&&d.classList.add("first"),i.indexOf(u)===i.length-1&&d.classList.add("last"),s?.append(d)}),te(t),V(n),ae(e),s.dataset.finish="finish"}function F(e,t,n,a,s,c){const i=t,u=e;e.dataset.finish||(i.dataset.position==="touch-block"?(u.append(t),i.dataset.position="puzzle-block",Te(t.textContent??""),Be()&&(te(n),Oe(a),V(a),ae(s),u.dataset.finish="finish"),Re(a)):t.dataset.position==="puzzle-block"&&(Ie(t,a),ee(n),c.append(t),i.dataset.position="touch-block",Ae(t.textContent??""),ne(a)))}function O(e){const t=e,n=h().currentTranslation;return t.textContent=n,n}function W(e,t,n,a){const s=h(),{sourceWords:c}=s,i=r({tag:"div",className:"game-page__puzzle-string"});t.append(i),Le(c).forEach(u=>{const d=r({tag:"div",className:"game-page__touch-element",textContent:u,dataset:{position:"touch-block"}});c.indexOf(u)===0&&d.classList.add("first"),c.indexOf(u)===c.length-1&&d.classList.add("last"),e.append(d),d.addEventListener("pointerdown",m=>{m.target.closest(".game-page__puzzle-string")?.dataset.finish!=="finish"&&we(m,t,()=>{F(i,d,n,a,t,e)})}),d.addEventListener("pointerup",()=>{Ee()||F(i,d,n,a,t,e)})})}async function qe(e,t,n,a){me(),h().isRoundOver&&(t.replaceChildren(),await ze()),W(e,t,n,a)}function je(e){const t=e;ke().includes(t.textContent??"")&&G()?t.classList.add("game-page__touch-element--invalid"):t.classList.remove("game-page__touch-element--invalid")}function M(e){Ce(e)}function J(){return xe()}let z=null,P=!1;function De(e,t){if(P)return;const n=h().currentAudioPath;z?z.src=n:z=new Audio(n),P=!0;const a=e,s=t;a.classList.remove("game-page__speaker-btn--inactive"),s.src="/jasonscriptlord-JSFE2025Q3/rss-puzzle/icons/speaker_162093.png",z.onended=()=>{P=!1,e.classList.add("game-page__speaker-btn--inactive"),s.src="/jasonscriptlord-JSFE2025Q3/rss-puzzle/icons/silent_2757171.png"},z.onerror=()=>{P=!1,e.classList.add("game-page__speaker-btn--inactive"),s.src="/jasonscriptlord-JSFE2025Q3/rss-puzzle/icons/silent_2757171.png"},z.play()}async function Fe(e){await I(e);const t=h(),n=document.querySelector(".page");n.replaceChildren(),document.querySelector(".game-page__touch-block")?.replaceChildren(),document.querySelector(".game-page__audio-block")?.replaceChildren(),document.querySelector(".game-page__puzzle-block")?.replaceChildren();for(let i=1;i<=t.pages;i+=1){const u=r({tag:"option",className:"game-page__option-level",textContent:String(i),value:String(i)});n.append(u)}}function Me(e){Y(e)}async function Je(e,t){Y(e),await I(t),document.querySelector(".game-page__touch-block")?.replaceChildren(),document.querySelector(".game-page__audio-block")?.replaceChildren(),document.querySelector(".game-page__puzzle-block")?.replaceChildren()}function He(){const e=h().pages,t=r({tag:"div",className:"game-page__container"}),n=r({tag:"div",className:"game-page__control-panel"}),a=r({tag:"div",className:"game-page__lable-level",textContent:"Level"}),s=r({tag:"select",className:"game-page__select-level"});for(let p=1;p<=6;p+=1){const y=r({tag:"option",className:"game-page__option-level",textContent:String(p),value:String(p)});s.append(y)}const c=r({tag:"div",className:"game-page__lable-level",textContent:"Page"}),i=r({tag:"select",className:"game-page__select-level page"});for(let p=1;p<=e;p+=1){const y=r({tag:"option",className:"game-page__option-level",textContent:String(p),value:String(p)});i.append(y)}const u=r({tag:"div",className:"game-page__drop-block"});u.append(a,s,c,i);const d=r({tag:"div",className:"game-page__btn-block"}),m=r({tag:"button",className:"game-page__hint-btn game-page__hint-btn--inactive"}),T=r({tag:"img",className:"game-page__hint-img"});m.append(T),T.src="/jasonscriptlord-JSFE2025Q3/rss-puzzle/icons/hint.png";const k=r({tag:"button",className:"game-page__speaker-btn game-page__speaker-btn--inactive"}),N=r({tag:"img",className:"game-page__speaker-img"});k.append(N),N.src="/jasonscriptlord-JSFE2025Q3/rss-puzzle/icons/silent_2757171.png",k.addEventListener("click",()=>{De(k,N)});const C=r({tag:"div",className:"game-page__audio-block"});h().hint&&O(C),m.addEventListener("click",()=>{J()?(M(!1),m.classList.add("game-page__hint-btn--inactive")):(M(!0),O(C),m.classList.remove("game-page__hint-btn--inactive"))});const _=r({tag:"div",className:"game-page__puzzle-block"}),b=r({tag:"div",className:"game-page__touch-block"}),f=r({tag:"button",className:"game-page__continue-btn",textContent:"Continue"}),g=r({tag:"button",className:"game-page__check-btn",textContent:"Check"});g.disabled=!0,g.addEventListener("click",()=>{const y=_.lastElementChild?.children;y&&Array.from(y).forEach(j=>{j instanceof HTMLElement&&je(j)})}),s.addEventListener("change",async()=>{Me(1),await Fe(Number(s.value)),W(b,_,f,g)}),i.addEventListener("change",async()=>{await Je(Number(i.value),Number(s.value)),W(b,_,f,g)}),W(b,_,f,g);const $=r({tag:"div",className:"game-page__confirmation-block"});f.disabled=!0,f.addEventListener("click",()=>{qe(b,_,f,g),ee(f),g.disabled=!0,ne(g),C.textContent="",J()&&O(C)});const q=r({tag:"button",className:"game-page__auto-complete-btn",textContent:"Autocomplete"});return q.addEventListener("click",()=>{$e(_,f,g,b)}),$.append(g,f,q),d.append(m,k),n.append(u,d),t.append(n,C,_,b,$),t}function Xe(){const e=localStorage.getItem("userData");B("login",ue),B("start",ge),B("game",He),w(e?"start":"login"),I(1)}const{body:Ye}=document,se=document.createElement("div");se.id="app";Ye.prepend(se);Xe();
