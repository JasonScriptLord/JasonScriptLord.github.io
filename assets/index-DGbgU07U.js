(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}})();function r(e){const t=document.createElement(e.tag);return e.className&&(t.className=e.className),e.textContent&&(t.textContent=e.textContent),e.id&&(t.id=e.id),e.dataset&&Object.entries(e.dataset).forEach(([n,a])=>{t.dataset[n]=a}),e.src!==void 0&&t.setAttribute("src",e.src),e.href!==void 0&&t.setAttribute("href",e.href),e.type!==void 0&&t.setAttribute("type",e.type),e.value!==void 0&&t.setAttribute("value",e.value),e.placeholder!==void 0&&t.setAttribute("placeholder",e.placeholder),e.checked!==void 0&&(e.checked?t.setAttribute("checked",""):t.removeAttribute("checked")),e.style&&(typeof e.style=="string"?t.style.cssText=e.style:Object.assign(t.style,e.style)),t}function se(e,t,n,a){const o=n,c=a;let i=!0;return e.value===""&&(o.textContent="Fill in the required fields",e.classList.add("authorization__first-name--invalid"),i=!1),t.value===""&&(c.textContent="Fill in the required fields",t.classList.add("authorization__last-name--invalid"),i=!1),e.value.length<3&&e.value!==""&&(o.textContent="Minimum 3 letters",i=!1),t.value.length<4&&t.value!==""&&(c.textContent="Minimum 4 letters",i=!1),i}function A(e,t){let n=!0;const a=t,o=/^[a-zA-Z-]*$/,c=/^[A-Z][a-zA-Z-]*$/,i=e.value.trim();return o.test(i)?c.test(i)?i.endsWith("-")?(a.textContent='Cannot end with "-"',n=!1):a.textContent="":(a.textContent="Start with a capital letter",n=!1):(a.textContent='Only English letters and "-""',n=!1),n}function ie(e,t){const n={firstName:e,lastName:t};localStorage.setItem("userData",JSON.stringify(n))}function le(){localStorage.removeItem("userData")}function re(){le()}function ce(){const e=localStorage.getItem("userData");if(e){const{firstName:t}=JSON.parse(e),{lastName:n}=JSON.parse(e);return`${t} ${n}`}return""}const X=new Map;function B(e,t){X.set(e,t)}async function w(e){const t=document.getElementById("app");if(!t)return;const n=X.get(e);n&&t.replaceChildren(n())}function ue(){const e=r({tag:"div",className:"authorization__container"}),t=r({tag:"h2",className:"authorization__title",textContent:"Authorization"}),n=r({tag:"input",className:"authorization__first-name",type:"text",placeholder:"First name",id:"first"});n.required=!0;const a=r({tag:"input",className:"authorization__last-name",type:"text",placeholder:"Last name",id:"Last"});a.required=!0;const o=r({tag:"button",className:"authorization__login-btn",type:"submit",textContent:"Login"}),c=r({tag:"div",className:"authorization__hint-first",textContent:""}),i=r({tag:"div",className:"authorization__hint-last",textContent:""});return n.addEventListener("input",()=>{n.classList.remove("authorization__first-name--invalid"),A(n,c)}),a.addEventListener("input",()=>{a.classList.remove("authorization__last-name--invalid"),A(a,i)}),o.addEventListener("click",()=>{const u=se(n,a,c,i),d=A(n,c);u&&d&&(ie(n.value,a.value),w("start"))}),e.append(t,n,c,a,i,o),e}const de={text:"RSS Puzzle is an interactive mini-game aimed at enhancing English language skills. Players assemble sentences from jumbled words, inspired by Lingualeo's Phrase Constructor training. The game integrates various levels of difficulty, hint options, and a unique puzzle-like experience with artwork."};function ge(){const e=r({tag:"div",className:"start-page"}),t=r({tag:"button",className:"start-page__logout-btn",textContent:"logout"}),n=r({tag:"div",className:"start-page__header"}),a=r({tag:"div",className:"start-page__logo"}),o=r({tag:"h1",textContent:"RSS Puzzle",className:"start-page__title"}),c=r({tag:"div",className:"start-page__content"}),i=r({tag:"p",className:"start-page__description",textContent:de.text});t.addEventListener("click",()=>{re(),w("login")});const u=r({tag:"p",className:"start-page__reetings",textContent:`Hello, ${ce()??""}! Let's solve some puzzles!`}),d=r({tag:"button",className:"start-page__start-button",textContent:"Start"});return d.addEventListener("click",()=>{w("game")}),n.append(a,o,t),c.append(i,u,d),e.append(n,c),e}const s={allWords:[],sourceWords:[],resultWords:[],translation:[],currentTranslation:"",pages:0,level:1,round:0,isRoundOver:!1,hint:!1,audioPaths:[],currentAudioPath:""};function pe(){s.allWords=[],s.sourceWords=[],s.resultWords=[],s.translation=[],s.currentTranslation="",s.audioPaths=[],s.currentAudioPath=""}async function Y(e){try{const t=await fetch(`/rss-puzzle-data/data/wordCollectionLevel${e}.json`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);pe();const n=await t.json();return n.rounds[s.round].words.forEach(a=>{s.allWords.push(a.textExample),s.translation.push(a.textExampleTranslate),s.audioPaths.push(a.audioExample)}),s.sourceWords=s.allWords.shift()?.split(" ")??[],s.currentTranslation=s.translation.shift()??"",s.currentAudioPath=s.audioPaths.shift()??"",s.pages=n.rounds.length,s.resultWords.length=0,s}catch(t){console.error("Error loading JSON:",t);return}}function fe(){s.isRoundOver=!0}function me(){if(s.allWords.length===0){fe(),s.sourceWords=[],s.resultWords=[],s.currentTranslation="";return}s.sourceWords=s.allWords.shift()?.split(" ")??[],s.currentTranslation=s.translation.shift()??"",s.currentAudioPath=s.audioPaths.shift()??"",s.resultWords.length=0}function he(){return structuredClone(s)}function _e(e){s.resultWords.push(e)}function ve(e){s.resultWords=s.resultWords.filter(t=>t!==e)}function be(){return s.sourceWords.join(" ")===s.resultWords.join(" ")}async function ye(){s.round+=1,await Y(s.level)}function G(e){s.round=e-1}async function ke(){s.isRoundOver=!1,await ye()}function J(){return s.sourceWords.length===s.resultWords.length}function Ce(){const e=[];return s.resultWords.forEach((t,n)=>{t!==s.sourceWords[n]&&e.push(t)}),e}function xe(e){s.hint=e}function ze(){return structuredClone(s.hint)}function Le(e){const t=[...e];for(let n=t.length-1;n>0;n-=1){const a=Math.floor(Math.random()*(n+1));[t[n],t[a]]=[t[a],t[n]]}return t}let l=null,R=null,U=0,Z=0,S=!1,v,K=0,V=0;const M=5;let z=null,L=null,E=null;function Ee(){return S}function Se(e,t){if(e.preventDefault(),e.stopPropagation(),!l)return;const n=Math.abs(e.clientX-K),a=Math.abs(e.clientY-V);if(!S){if(n<M&&a<M)return;S=!0}l.style.width=`${v.width}px`,l.style.height=`${v.height}px`,l.style.flex="0 0 auto",l.style.maxWidth="none",l.style.minWidth="unset",l.style.position="fixed",l.style.left=`${v.left}px`,l.style.top=`${v.top}px`,l.style.zIndex="1000",l.style.pointerEvents="none",l.classList.add("dragging"),l.style.left=`${e.clientX-U}px`,l.style.top=`${e.clientY-Z}px`;const o=l.dataset.position==="puzzle-block"?document.querySelector(".game-page__touch-block"):t.lastChild;o instanceof HTMLElement&&o.classList.add("hover")}function Ne(){if(l&&z!==null)try{l.releasePointerCapture(z)}catch{throw new Error("activePointerId error")}l&&(l.classList.remove("dragging"),l.style.position="",l.style.left="",l.style.top="",l.style.width="",l.style.height="",l.style.zIndex="",l.style.pointerEvents="",l.style.flex="",l.style.maxWidth="",l.style.minWidth=""),document.querySelectorAll(".game-page__puzzle-string").forEach(e=>e.classList.remove("hover")),document.querySelector(".game-page__touch-block")?.classList.remove("hover"),S=!1,l=null,R=null,z=null,L&&(document.removeEventListener("pointermove",L),L=null),E&&(document.removeEventListener("pointerup",E),E=null)}function Pe(e,t,n){const a=document.elementFromPoint(e,t),o=a?.closest(".game-page__puzzle-string"),c=a?.closest(".game-page__touch-block");return l&&l.dataset.position==="touch-block"&&o?n.lastElementChild:l&&l.dataset.position==="puzzle-block"&&c?document.querySelector(".game-page__touch-block"):null}function We(e,t,n){if(l){if(S){const a=Pe(e.clientX,e.clientY,n);a&&(a.appendChild(l),t())}Ne()}}function we(e,t,n){e.preventDefault(),e.stopPropagation(),l=e.target,l&&(R=l.closest(".game-page__touch-block")||l.closest(".game-page__puzzle-string"),R&&(v=l.getBoundingClientRect(),U=e.clientX-v.left,Z=e.clientY-v.top,K=e.clientX,V=e.clientY,z=e.pointerId,l.setPointerCapture(z),L=a=>Se(a,t),E=a=>We(a,n,t),document.addEventListener("pointermove",L),document.addEventListener("pointerup",E)))}async function I(e){return Y(e)}function h(){return he()}function Te(e){_e(e)}function Ae(e){ve(e)}function Be(){return be()}function Oe(e){const t=e;t.disabled=!0}function Q(e){e.classList.add("game-page__check-btn--inactive")}function ee(e){const t=e;t.disabled=!0,t.classList.remove("game-page__continue-btn--active")}function te(e){const t=e;t.disabled=!1,t.classList.add("game-page__continue-btn--active")}function Re(e){const t=e;J()&&(t.disabled=!1)}function ne(e){e.classList.remove("game-page__check-btn--inactive")}function Ie(e,t){const n=t;e.classList.remove("game-page__touch-element--invalid"),n.disabled=!0}function ae(e){const n=e.lastElementChild?.children;n&&Array.from(n).forEach(a=>{a instanceof HTMLElement&&a.classList.remove("game-page__touch-element--invalid")})}function $e(e,t,n,a){const o=e.lastElementChild;if(!o)return;const c=h(),{sourceWords:i}=c;o.replaceChildren(),a.replaceChildren(),i.forEach(u=>{const d=r({tag:"div",className:"game-page__touch-element",textContent:u,dataset:{position:"puzzle-block"}});i.indexOf(u)===0&&d.classList.add("first"),i.indexOf(u)===i.length-1&&d.classList.add("last"),o?.append(d)}),te(t),Q(n),ae(e),o.dataset.finish="finish"}function j(e,t,n,a,o,c){const i=t,u=e;e.dataset.finish||(i.dataset.position==="touch-block"?(u.append(t),i.dataset.position="puzzle-block",Te(t.textContent??""),Be()&&(te(n),Oe(a),Q(a),ae(o),u.dataset.finish="finish"),Re(a)):t.dataset.position==="puzzle-block"&&(Ie(t,a),ee(n),c.append(t),i.dataset.position="touch-block",Ae(t.textContent??""),ne(a)))}function O(e){const t=e,n=h().currentTranslation;return t.textContent=n,n}function W(e,t,n,a){const o=h(),{sourceWords:c}=o,i=r({tag:"div",className:"game-page__puzzle-string"});t.append(i),Le(c).forEach(u=>{const d=r({tag:"div",className:"game-page__touch-element",textContent:u,dataset:{position:"touch-block"}});c.indexOf(u)===0&&d.classList.add("first"),c.indexOf(u)===c.length-1&&d.classList.add("last"),e.append(d),d.addEventListener("pointerdown",m=>{m.target.closest(".game-page__puzzle-string")?.dataset.finish!=="finish"&&we(m,t,()=>{j(i,d,n,a,t,e)})}),d.addEventListener("pointerup",()=>{Ee()||j(i,d,n,a,t,e)})})}async function qe(e,t,n,a){me(),h().isRoundOver&&(t.replaceChildren(),await ke()),W(e,t,n,a)}function De(e){const t=e;Ce().includes(t.textContent??"")&&J()?t.classList.add("game-page__touch-element--invalid"):t.classList.remove("game-page__touch-element--invalid")}function F(e){xe(e)}function H(){return ze()}let k=null,P=!1;function Me(e,t){if(P)return;const n=h().currentAudioPath;k?k.src=n:k=new Audio(n),P=!0;const a=e,o=t;a.classList.remove("game-page__speaker-btn--inactive"),o.src="/icons/speaker_162093.png",k.onended=()=>{P=!1,e.classList.add("game-page__speaker-btn--inactive"),o.src="/icons/silent_2757171.png"},k.onerror=()=>{P=!1,e.classList.add("game-page__speaker-btn--inactive"),o.src="/icons/silent_2757171.png"},k.play()}async function je(e){await I(e);const t=h(),n=document.querySelector(".page");n.replaceChildren(),document.querySelector(".game-page__touch-block")?.replaceChildren(),document.querySelector(".game-page__audio-block")?.replaceChildren(),document.querySelector(".game-page__puzzle-block")?.replaceChildren();for(let i=1;i<=t.pages;i+=1){const u=r({tag:"option",className:"game-page__option-level",textContent:String(i),value:String(i)});n.append(u)}}function Fe(e){G(e)}async function He(e,t){G(e),await I(t),document.querySelector(".game-page__touch-block")?.replaceChildren(),document.querySelector(".game-page__audio-block")?.replaceChildren(),document.querySelector(".game-page__puzzle-block")?.replaceChildren()}function Xe(){const e=h().pages,t=r({tag:"div",className:"game-page__container"}),n=r({tag:"div",className:"game-page__control-panel"}),a=r({tag:"div",className:"game-page__lable-level",textContent:"Level"}),o=r({tag:"select",className:"game-page__select-level"});for(let p=1;p<=6;p+=1){const y=r({tag:"option",className:"game-page__option-level",textContent:String(p),value:String(p)});o.append(y)}const c=r({tag:"div",className:"game-page__lable-level",textContent:"Page"}),i=r({tag:"select",className:"game-page__select-level page"});for(let p=1;p<=e;p+=1){const y=r({tag:"option",className:"game-page__option-level",textContent:String(p),value:String(p)});i.append(y)}const u=r({tag:"div",className:"game-page__drop-block"});u.append(a,o,c,i);const d=r({tag:"div",className:"game-page__btn-block"}),m=r({tag:"button",className:"game-page__hint-btn game-page__hint-btn--inactive"}),T=r({tag:"img",className:"game-page__hint-img"});m.append(T),T.src="/icons/hint.png";const C=r({tag:"button",className:"game-page__speaker-btn game-page__speaker-btn--inactive"}),N=r({tag:"img",className:"game-page__speaker-img"});C.append(N),N.src="/icons/silent_2757171.png",C.addEventListener("click",()=>{Me(C,N)});const x=r({tag:"div",className:"game-page__audio-block"});h().hint&&O(x),m.addEventListener("click",()=>{H()?(F(!1),m.classList.add("game-page__hint-btn--inactive")):(F(!0),O(x),m.classList.remove("game-page__hint-btn--inactive"))});const _=r({tag:"div",className:"game-page__puzzle-block"}),b=r({tag:"div",className:"game-page__touch-block"}),f=r({tag:"button",className:"game-page__continue-btn",textContent:"Continue"}),g=r({tag:"button",className:"game-page__check-btn",textContent:"Check"});g.disabled=!0,g.addEventListener("click",()=>{const y=_.lastElementChild?.children;y&&Array.from(y).forEach(D=>{D instanceof HTMLElement&&De(D)})}),o.addEventListener("change",async()=>{Fe(1),await je(Number(o.value)),W(b,_,f,g)}),i.addEventListener("change",async()=>{await He(Number(i.value),Number(o.value)),W(b,_,f,g)}),W(b,_,f,g);const $=r({tag:"div",className:"game-page__confirmation-block"});f.disabled=!0,f.addEventListener("click",()=>{qe(b,_,f,g),ee(f),g.disabled=!0,ne(g),x.textContent="",H()&&O(x)});const q=r({tag:"button",className:"game-page__auto-complete-btn",textContent:"Autocomplete"});return q.addEventListener("click",()=>{$e(_,f,g,b)}),$.append(g,f,q),d.append(m,C),n.append(u,d),t.append(n,x,_,b,$),t}function Ye(){const e=localStorage.getItem("userData");B("login",ue),B("start",ge),B("game",Xe),w(e?"start":"login"),I(1)}const{body:Ge}=document,oe=document.createElement("div");oe.id="app";Ge.prepend(oe);Ye();
